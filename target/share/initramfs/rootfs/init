#!/bin/sh

HOME=/
PATH=/sbin:/bin:/usr/sbin:/usr/bin
export HOME PATH

echo "Mounting /dev, /dev/pts, /proc, /usbfs and /sys ..."
mount -t tmpfs  none /dev -o mode=755
mkdir /dev/pts
mount -t devpts none /dev/pts
mount -t proc   none /proc
mount -t usbfs  none /proc/bus/usb 2> /dev/null
mount -t sysfs  none /sys
ln -s /proc/self/fd /dev/fd

echo "Populating u/dev ..."
mknod /dev/tty1 c 4 1
mknod /dev/tty2 c 4 2
mknod /dev/tty3 c 4 3
udevd --daemon
udevadm trigger
udevadm settle

# make some directories
mkdir /offload /cf /var/etc /var/db

# setup symbolic links
ln -s /cf/conf /conf

exec /sbin/init $*
